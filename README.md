# Интеллектуальный агент для автоматизации документооборота

## Описание

Данный проект реализует интеллектуального агента на базе LLM (GigaChat) и LangChain для автоматизации работы с документами:
- Генерация .docx документов по шаблонам
- Автоматизация документооборота
- Поиск и анализ информации через внешние MCP-инструменты
- Гибкая настройка и расширяемость

## Основные возможности
- **Создание документов по шаблонам** (например, докладная записка)
- **Анализ и валидация шаблонов** (поиск переменных, проверка структуры)
- **Поиск актуальной информации** (через Tavily и другие MCP)
- **Логирование всех действий**
- **Явная обработка ключевых слов**: запросы типа "создай докладную" автоматически используют нужный шаблон

## Структура проекта

```
├── agent.py                  # Главный агент (логика, интеграция LLM и MCP)
├── install_requirements.bat  # Скрипт установки зависимостей и создания .env
├── run_agent.bat             # Скрипт запуска агента
├── requirements.txt          # Зависимости Python
├── rules.json                # Правила и роль агента
├── mcp_servers.json          # Конфигурация MCP-серверов
├── test_report_template.py   # Пример теста генерации отчёта
├── README.md                 # Документация
├── mcp_modules/              # MCP-модули
│   └── doc_generator.py      # MCP-сервер генерации документов
├── templates/                # Шаблоны .docx
│   ├── докладная записка.docx
│   └── report_template.docx
├── output/                   # Сгенерированные документы
│   └── report_filled_test.docx
├── logs/                     # Логи работы агента
```

## Быстрый старт

1. **Установите зависимости:**
   ```bat
   install_requirements.bat
   ```
   или вручную:
   ```bash
   pip install -r requirements.txt
   ```
2. **Создайте файл `.env`** (если не создался автоматически):
   ```env
   GIGACHAT_CREDENTIALS=your_gigachat_token
   GIGACHAT_SCOPE=GIGACHAT_API_PERS
   TAVILY_API_KEY=your_tavily_api_key
   ```
3. **Запустите агента:**
   ```bat
   run_agent.bat
   ```
   или вручную:
   ```bash
   python agent.py
   ```

## Использование

- Введите команду или запрос, например:
  - `создай докладную` или `подготовь докладную записку`
  - Агент запросит основной текст, автоматически подставит его в шаблон `докладная записка.docx` и сгенерирует файл в папке `output/`.
- Для других документов добавьте шаблон в папку `templates/` и расширьте ключевые слова в коде.
- Доступны команды:
  - `помощь` — список возможностей
  - `статус` — информация о системе
  - `выход` — завершение работы

## MCP-модули
- `doc_generator.py` — генерация и анализ .docx шаблонов (интеграция через context7-mcp)
- Подключение других MCP-инструментов настраивается через `mcp_servers.json`

## Пример шаблона .docx
- Положите шаблон в папку `templates/` (например, `докладная записка.docx`)
- Используйте переменные в формате `{{ variable_name }}` (например, `{{ text }}` для основного текста)

## Расширение функционала
- Для поддержки новых типов документов:
  1. Добавьте шаблон в папку `templates/`
  2. Добавьте ключевые слова и обработку в `agent.py`
  3. (Опционально) Добавьте новые MCP-инструменты в `mcp_servers.json`

## Логи
- Все логи сохраняются в папке `logs/`

## Авторы и поддержка
- Проект создан для автоматизации документооборота с помощью LLM, LangChain и MCP.
- Вопросы и предложения: [ваш email или контакт] 